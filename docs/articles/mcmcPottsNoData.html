<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>bayesImageS::mcmcPottsNoData • bayesImageS</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">bayesImageS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mcmcPotts.html">bayesImageS::mcmcPotts</a>
    </li>
    <li>
      <a href="../articles/mcmcPottsNoData.html">bayesImageS::mcmcPottsNoData</a>
    </li>
    <li>
      <a href="../articles/swNoData.html">bayesImageS::swNoData</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>bayesImageS::mcmcPottsNoData</h1>
                        <h4 class="author">Matt Moores</h4>
            
            <h4 class="date">16 January 2017</h4>
          </div>

    
    
<div class="contents">
<p>This is a follow up to <a href="https://mattstats.wordpress.com/2013/12/13/swnodata/">my previous post</a> about the Swendsen-Wang (SW) algorithm, where I mentioned that SW has better convergence properties than Gibbs when the inverse temperature parameter <span class="math inline">\(\beta\)</span> is large. This difference can be quantified by initialising the two algorithms at known starting points and measuring how many iterations it takes to converge. This is the second in a series of posts describing the functions and algorithms that I have implemented in the R package <strong>bayesImageS</strong>, which is <a href="https://CRAN.R-project.org/package=bayesImageS">now available on CRAN</a>.</p>
<hr>
<p>The Potts model has a doubly-intractable likelihood, so its expectation and variance cannot be computed exactly. Instead, we can use Markov chain Monte Carlo (MCMC) algorithms such as SW or Gibbs sampling to simulate from its distribution for a given value of <span class="math inline">\(\beta\)</span>. However, we need to know how many MCMC iterations to use, so that the chain will have converged to a steady state. Otherwise, any inference using the MCMC samples will be biased.</p>
<p>In the following, the labels <strong>z</strong> of the Potts model can take <em>k</em> different values. This state space is not ordered, so algorithms such as perfect sampling (Propp &amp; Wilson, 1996; Huber, 2016) cannot be applied. The Potts model is a member of the exponential family, so it has a sufficient statistic S(<strong>z</strong>) which is the count of like neighbours. The maximum value of S(<strong>z</strong>), which we will call <span class="math inline">\(M\)</span>, is equal to <span class="math inline">\(2(n - \sqrt{n})\)</span> for a regular, square lattice. For example, <span class="math inline">\(M = 112\)</span> for an 8x8 lattice; <span class="math inline">\(M = 31,000\)</span> for 125x125; and <span class="math inline">\(M = 1,998,000\)</span> for 1000x1000.</p>
<p>There are two exceptions where the distribution of the Potts model can be computed exactly. When <span class="math inline">\(\beta=0\)</span> the labels z are independent, hence the sufficient statistic S(<strong>z</strong>) follows a Binomial distribution with expectation <span class="math inline">\(M/k\)</span> and variance <span class="math inline">\(M(1/k)(1 - 1/k)\)</span>. For an 8x8 lattice with k=3, the expectation is <code>64/3</code> with a variance of 24.89. As β approaches infinity, all of the labels have the same value almost surely. This means that the expectation approaches M asymptotically, while the variance approaches 0.</p>
<p>We can use the endpoints of the distribution to estimate how long the SW and Gibbs algorithms take to converge. The algorithm is initialised at one endpoint, then we monitor S(<strong>z</strong>) at each iteration until the distribution of the samples has converged to the known expectation and variance. First, let’s look at chequerboard Gibbs sampling for an 8×8 lattice with <em>k</em>=3:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">k &lt;-<span class="st"> </span><span class="dv">3</span>
n &lt;-<span class="st"> </span><span class="dv">8</span><span class="op">*</span><span class="dv">8</span>
mask &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dt">nrow=</span><span class="kw">sqrt</span>(n),<span class="dt">ncol=</span><span class="kw">sqrt</span>(n))
neigh &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getNeighbors.html">getNeighbors</a></span>(mask, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))
block &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getBlocks.html">getBlocks</a></span>(mask, <span class="dv">2</span>)
edges &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getEdges.html">getEdges</a></span>(mask, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))
<span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(mask),<span class="st">"pixels"</span>))</code></pre></div>
<pre><code>## [1] "64 pixels"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">"maximum sufficient statistic S(z) ="</span>,<span class="kw">nrow</span>(edges)))</code></pre></div>
<pre><code>## [1] "maximum sufficient statistic S(z) = 112"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.Gibbs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mcmcPottsNoData.html">mcmcPottsNoData</a></span>(<span class="dt">beta=</span><span class="dv">5</span>, <span class="dt">k=</span><span class="dv">3</span>, neigh, block, <span class="dt">niter=</span><span class="dv">50</span>)
<span class="kw">ts.plot</span>(res.Gibbs<span class="op">$</span>sum, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="kw">nrow</span>(edges)<span class="op">/</span><span class="dv">3</span>, <span class="kw">nrow</span>(edges)))
<span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">nrow</span>(edges), <span class="dt">col=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">3</span>)</code></pre></div>
<div class="figure">
<img src="mcmcPottsNoData_files/figure-html/unnamed-chunk-1-1.png" alt="Chequerboard Gibbs sampling for a regular 8x8 lattice with k=3 labels." width="672"><p class="caption">
Chequerboard Gibbs sampling for a regular 8x8 lattice with k=3 labels.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(res.Gibbs<span class="op">$</span>sum[<span class="dv">36</span><span class="op">:</span><span class="dv">50</span>])</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##     112     112     112     112     112     112</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(res.Gibbs<span class="op">$</span>sum[<span class="dv">36</span><span class="op">:</span><span class="dv">50</span>])</code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>We can see that it only takes around 35 iterations for the Gibbs sampler to converge for a lattice of that size. Now for a 125×125 lattice:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">125</span><span class="op">*</span><span class="dv">125</span>
mask &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dt">nrow=</span><span class="kw">sqrt</span>(n),<span class="dt">ncol=</span><span class="kw">sqrt</span>(n))
neigh &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getNeighbors.html">getNeighbors</a></span>(mask, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))
block &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getBlocks.html">getBlocks</a></span>(mask, <span class="dv">2</span>)
edges &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getEdges.html">getEdges</a></span>(mask, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))
<span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(mask),<span class="st">"pixels"</span>))</code></pre></div>
<pre><code>## [1] "15625 pixels"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">"maximum sufficient statistic S(z) ="</span>,<span class="kw">nrow</span>(edges)))</code></pre></div>
<pre><code>## [1] "maximum sufficient statistic S(z) = 31000"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.Gibbs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mcmcPottsNoData.html">mcmcPottsNoData</a></span>(<span class="dt">beta=</span><span class="dv">5</span>, <span class="dt">k=</span><span class="dv">3</span>, neigh, block, <span class="dt">niter=</span><span class="dv">2000</span>)
<span class="kw">ts.plot</span>(res.Gibbs<span class="op">$</span>sum, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="kw">nrow</span>(edges)<span class="op">/</span><span class="dv">3</span>, <span class="kw">nrow</span>(edges)))
<span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">nrow</span>(edges), <span class="dt">col=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">3</span>)</code></pre></div>
<div class="figure">
<img src="mcmcPottsNoData_files/figure-html/unnamed-chunk-2-1.png" alt="Chequerboard Gibbs sampling for a regular 125x125 lattice with k=3 labels." width="672"><p class="caption">
Chequerboard Gibbs sampling for a regular 125x125 lattice with k=3 labels.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(res.Gibbs<span class="op">$</span>sum[<span class="dv">1001</span><span class="op">:</span><span class="dv">2000</span>])</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   30479   30567   30614   30601   30642   30655</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(res.Gibbs<span class="op">$</span>sum[<span class="dv">1001</span><span class="op">:</span><span class="dv">2000</span>])</code></pre></div>
<pre><code>## [1] 1797.793</code></pre>
<p>Even after 2000 iterations, the distribution of S(<strong>z</strong>) might not have converged to the known value. Now let’s see how Swendsen-Wang performs for the same lattice:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.SW &lt;-<span class="st"> </span><span class="kw"><a href="../reference/swNoData.html">swNoData</a></span>(<span class="dt">beta=</span><span class="dv">5</span>, <span class="dt">k=</span><span class="dv">3</span>, neigh, block, <span class="dt">niter=</span><span class="dv">50</span>)
<span class="kw">ts.plot</span>(res.SW<span class="op">$</span>sum, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="kw">nrow</span>(edges)<span class="op">/</span><span class="dv">3</span>, <span class="kw">nrow</span>(edges)))
<span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">nrow</span>(edges), <span class="dt">col=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="mcmcPottsNoData_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(res.SW<span class="op">$</span>sum[<span class="dv">26</span><span class="op">:</span><span class="dv">50</span>])</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   31000   31000   31000   31000   31000   31000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(res.SW<span class="op">$</span>sum[<span class="dv">26</span><span class="op">:</span><span class="dv">50</span>])</code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>After 25 iterations, SW has already converged to the exact distribution. Even though this algorithm is much more expensive for each iteration, it more than makes up for that in efficiency when <span class="math inline">\(\beta\)</span> is large.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">1000</span><span class="op">*</span><span class="dv">1000</span>
mask &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dt">nrow=</span><span class="kw">sqrt</span>(n),<span class="dt">ncol=</span><span class="kw">sqrt</span>(n))
neigh &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getNeighbors.html">getNeighbors</a></span>(mask, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))
block &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getBlocks.html">getBlocks</a></span>(mask, <span class="dv">2</span>)
edges &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getEdges.html">getEdges</a></span>(mask, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))
<span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(mask),<span class="st">"pixels"</span>))</code></pre></div>
<pre><code>## [1] "1e+06 pixels"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">"maximum sufficient statistic S(z) ="</span>,<span class="kw">nrow</span>(edges)))</code></pre></div>
<pre><code>## [1] "maximum sufficient statistic S(z) = 1998000"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.SW &lt;-<span class="st"> </span><span class="kw"><a href="../reference/swNoData.html">swNoData</a></span>(<span class="dt">beta=</span><span class="dv">5</span>, <span class="dt">k=</span><span class="dv">3</span>, neigh, block, <span class="dt">niter=</span><span class="dv">100</span>)
<span class="kw">ts.plot</span>(res.SW<span class="op">$</span>sum, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="kw">nrow</span>(edges)<span class="op">/</span><span class="dv">3</span>, <span class="kw">nrow</span>(edges)))
<span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">nrow</span>(edges), <span class="dt">col=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="mcmcPottsNoData_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(res.SW<span class="op">$</span>sum[<span class="dv">81</span><span class="op">:</span><span class="dv">100</span>])</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 1998000 1998000 1998000 1998000 1998000 1998000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(res.SW<span class="op">$</span>sum[<span class="dv">81</span><span class="op">:</span><span class="dv">100</span>])</code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Now let’s see what happens when we go in the other direction: initialising the lattice with all labels set to the same value, then updating with <span class="math inline">\(\beta=0\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">125</span><span class="op">*</span><span class="dv">125</span>
mask &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dt">nrow=</span><span class="kw">sqrt</span>(n),<span class="dt">ncol=</span><span class="kw">sqrt</span>(n))
neigh &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getNeighbors.html">getNeighbors</a></span>(mask, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))
block &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getBlocks.html">getBlocks</a></span>(mask, <span class="dv">2</span>)
edges &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getEdges.html">getEdges</a></span>(mask, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))
<span class="kw">system.time</span>(res2.Gibbs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mcmcPottsNoData.html">mcmcPottsNoData</a></span>(<span class="dt">beta=</span><span class="dv">0</span>, <span class="dt">k=</span><span class="dv">3</span>, neigh, block, <span class="dt">niter=</span><span class="dv">100</span>, <span class="dt">random=</span><span class="ot">FALSE</span>))</code></pre></div>
<pre><code>##    user  system elapsed 
##   0.394   0.028   0.144</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ts.plot</span>(res2.Gibbs<span class="op">$</span>sum, <span class="dt">ylim=</span><span class="kw">range</span>(<span class="kw">c</span>(res2.Gibbs<span class="op">$</span>sum, <span class="kw">nrow</span>(edges))))
<span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">nrow</span>(edges), <span class="dt">col=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">nrow</span>(edges)<span class="op">/</span><span class="dv">3</span>, <span class="dt">col=</span><span class="dv">4</span>, <span class="dt">lty=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="mcmcPottsNoData_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(res2.Gibbs<span class="op">$</span>sum[<span class="dv">51</span><span class="op">:</span><span class="dv">100</span>])</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   10129   10268   10332   10332   10394   10514</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(res2.Gibbs<span class="op">$</span>sum[<span class="dv">51</span><span class="op">:</span><span class="dv">100</span>])</code></pre></div>
<pre><code>## [1] 7486.134</code></pre>
<p>The distribution of all 500 samples are very close to the exact distribution with mean 10333.33 and variance 6888.89:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">muSz &lt;-<span class="st"> </span><span class="kw">nrow</span>(edges)<span class="op">/</span><span class="dv">3</span>
sdSz &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">nrow</span>(edges)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)<span class="op">*</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">3</span>))
<span class="kw">hist</span>(res2.Gibbs<span class="op">$</span>sum[<span class="dv">51</span><span class="op">:</span><span class="dv">100</span>], <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">breaks=</span><span class="dv">20</span>, <span class="dt">col=</span><span class="dv">3</span>,
     <span class="dt">xlim=</span><span class="kw">range</span>(<span class="kw">c</span>(res2.Gibbs<span class="op">$</span>sum,muSz <span class="op">-</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>sdSz, muSz <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>sdSz)))
<span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">nrow</span>(edges)<span class="op">/</span><span class="dv">3</span>, <span class="dt">col=</span><span class="dv">4</span>, <span class="dt">lty=</span><span class="dv">3</span>, <span class="dt">lwd=</span><span class="dv">3</span>)
<span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean=</span><span class="kw">nrow</span>(edges)<span class="op">/</span><span class="dv">3</span>, <span class="dt">sd=</span><span class="kw">sqrt</span>(<span class="kw">nrow</span>(edges)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)<span class="op">*</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">3</span>))), 
          <span class="dt">col=</span><span class="st">"darkblue"</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">yaxt=</span><span class="st">"n"</span>)</code></pre></div>
<p><img src="mcmcPottsNoData_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>Now for Swendsen-Wang:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(res2.SW &lt;-<span class="st"> </span><span class="kw"><a href="../reference/swNoData.html">swNoData</a></span>(<span class="dt">beta=</span><span class="dv">0</span>, <span class="dt">k=</span><span class="dv">3</span>, neigh, block, <span class="dt">niter=</span><span class="dv">100</span>, <span class="dt">random=</span><span class="ot">FALSE</span>))</code></pre></div>
<pre><code>##    user  system elapsed 
##   0.753   0.051   0.226</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ts.plot</span>(res2.SW<span class="op">$</span>sum, <span class="dt">ylim=</span><span class="kw">range</span>(<span class="kw">c</span>(res2.SW<span class="op">$</span>sum, <span class="kw">nrow</span>(edges))))
<span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">nrow</span>(edges), <span class="dt">col=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">nrow</span>(edges)<span class="op">/</span><span class="dv">3</span>, <span class="dt">col=</span><span class="dv">4</span>, <span class="dt">lty=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="mcmcPottsNoData_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(res2.SW<span class="op">$</span>sum[<span class="dv">51</span><span class="op">:</span><span class="dv">100</span>])</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   10156   10291   10332   10331   10368   10505</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(res2.SW<span class="op">$</span>sum[<span class="dv">51</span><span class="op">:</span><span class="dv">100</span>])</code></pre></div>
<pre><code>## [1] 6868.608</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(res2.SW<span class="op">$</span>sum[<span class="dv">51</span><span class="op">:</span><span class="dv">100</span>], <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">breaks=</span><span class="dv">20</span>, <span class="dt">col=</span><span class="dv">3</span>,
     <span class="dt">xlim=</span><span class="kw">range</span>(<span class="kw">c</span>(res2.Gibbs<span class="op">$</span>sum,muSz <span class="op">-</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>sdSz, muSz <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>sdSz)))
<span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">nrow</span>(edges)<span class="op">/</span><span class="dv">3</span>, <span class="dt">col=</span><span class="dv">4</span>, <span class="dt">lty=</span><span class="dv">3</span>, <span class="dt">lwd=</span><span class="dv">3</span>)
<span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean=</span>muSz, <span class="dt">sd=</span>sdSz), 
          <span class="dt">col=</span><span class="st">"darkblue"</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">yaxt=</span><span class="st">"n"</span>)</code></pre></div>
<p><img src="mcmcPottsNoData_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Matt Moores, Kerrie Mengersen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
